<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Weather Pro iOS</title>
    <style>
        :root {
            --ios-blue: #007AFF;
            --glass: rgba(255, 255, 255, 0.15);
            --bg-sunny: linear-gradient(180deg, #4da0ff 0%, #a3d5ff 100%);
            --bg-cloudy: linear-gradient(180deg, #718096 0%, #a0aec0 100%);
            --bg-rainy: linear-gradient(180deg, #2d3748 0%, #4a5568 100%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
            margin: 0; padding: 0;
            color: white;
            min-height: 100vh;
            transition: background 1s ease;
            background: var(--bg-sunny);
            overflow-x: hidden;
        }

        /* --- WEATHER ANIMATIONS --- */
        .weather-bg-fx { position: fixed; inset: 0; z-index: -1; overflow: hidden; pointer-events: none; }
        .sun-ray { position: absolute; top: -50px; right: -50px; width: 300px; height: 300px; background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, transparent 70%); animation: pulse 4s infinite alternate; }
        .cloud-fx { position: absolute; background: rgba(255,255,255,0.2); border-radius: 50%; filter: blur(40px); animation: float 20s infinite linear; }
        
        @keyframes pulse { from { transform: scale(1); opacity: 0.4; } to { transform: scale(1.2); opacity: 0.7; } }
        @keyframes float { from { left: -200px; } to { left: 100%; } }

        .app-container { max-width: 450px; margin: 0 auto; padding: 60px 20px 20px; text-align: center; }

        /* Main Header */
        .header-main h1 { font-size: 34px; font-weight: 400; margin: 0; }
        .current-temp { font-size: 96px; font-weight: 200; margin: 10px 0; }
        .current-desc { font-size: 20px; font-weight: 500; opacity: 0.9; text-transform: capitalize; }
        .high-low { font-size: 20px; font-weight: 500; margin-top: 5px; }

        /* Glass Section */
        .section-card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            margin-top: 25px;
            padding: 15px;
            text-align: left;
        }

        .section-title { font-size: 13px; font-weight: 600; text-transform: uppercase; opacity: 0.6; margin-bottom: 12px; display: flex; align-items: center; gap: 5px; }

        /* Hourly List */
        .hourly-list { display: flex; gap: 20px; overflow-x: auto; padding-bottom: 10px; scrollbar-width: none; }
        .hourly-item { text-align: center; min-width: 50px; }
        .hourly-item .time { font-size: 15px; font-weight: 600; margin-bottom: 8px; }
        .hourly-item .icon { font-size: 24px; margin: 8px 0; }
        .hourly-item .temp { font-size: 17px; font-weight: 600; }

        /* 10-Day Forecast (Vertical like iPhone) */
        .daily-row {
            display: grid;
            grid-template-columns: 1fr 40px 1fr;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .daily-row:last-child { border-bottom: none; }
        .day-name { font-size: 18px; font-weight: 600; }
        .day-icon { font-size: 22px; text-align: center; }
        
        /* Temp Bar Logic */
        .temp-bar-container { display: flex; align-items: center; justify-content: flex-end; gap: 10px; }
        .temp-bar { 
            width: 80px; height: 4px; background: rgba(0,0,0,0.2); border-radius: 10px; position: relative;
        }
        .temp-bar-fill {
            position: absolute; height: 100%; background: linear-gradient(90deg, #5ac8fa, #ffcc00, #ff3b30); border-radius: 10px;
        }

        /* Search Bar */
        .search-box { position: fixed; top: 15px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 400px; z-index: 100; }
        input {
            width: 100%; padding: 10px 15px; border-radius: 10px; border: none; 
            background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); color: white; outline: none;
        }
        input::placeholder { color: rgba(255,255,255,0.6); }

        .suggestions { background: white; color: black; border-radius: 10px; margin-top: 5px; display: none; }
        .suggestion-item { padding: 12px; border-bottom: 1px solid #eee; cursor: pointer; }
    </style>
</head>
<body id="body">

    <div class="weather-bg-fx" id="bg-fx"></div>

    <div class="search-box">
        <input type="text" id="city-input" placeholder="üîç Search for a city">
        <div id="suggestions" class="suggestions"></div>
    </div>

    <div class="app-container">
        <div class="header-main">
            <h1 id="city-title">Vilnius</h1>
            <div class="current-temp" id="main-temp">--¬∞</div>
            <div class="current-desc" id="main-desc">Cloudy</div>
            <div class="high-low" id="main-hl">H:--¬∞ L:--¬∞</div>
        </div>

        <div class="section-card">
            <div class="section-title">üïí Hourly Forecast</div>
            <div class="hourly-list" id="hourly-list"></div>
        </div>

        <div class="section-card">
            <div class="section-title">üìÖ 10-Day Forecast</div>
            <div id="daily-list"></div>
        </div>
    </div>

<script>
    if (localStorage.getItem('isLoggedIn') !== 'true') window.location.href = 'index.html';

    const PROXY = "https://api.codetabs.com/v1/proxy/?quest=";
    let allPlaces = [];
    let currentData = null;

    const conditionIcons = { "clear": "‚òÄÔ∏è", "partly-cloudy": "‚õÖ", "cloudy": "‚òÅÔ∏è", "rain": "üåßÔ∏è", "heavy-rain": "‚õàÔ∏è", "snow": "‚ùÑÔ∏è" };

    async function init() {
        const res = await fetch(PROXY + encodeURIComponent("https://api.meteo.lt/v1/places"));
        allPlaces = await res.json();
        fetchWeather('vilnius', 'Vilnius');
    }

    async function fetchWeather(code, name) {
        const res = await fetch(PROXY + encodeURIComponent(`https://api.meteo.lt/v1/places/${code}/forecasts/long-term`));
        const data = await res.json();
        currentData = data.forecastTimestamps;
        
        document.getElementById('city-title').innerText = name;
        updateUI();
    }

    function updateUI() {
        const now = currentData[0];
        const temps = currentData.slice(0, 24).map(t => t.airTemperature);
        
        document.getElementById('main-temp').innerText = `${Math.round(now.airTemperature)}¬∞`;
        document.getElementById('main-desc').innerText = now.conditionCode.replace(/-/g, ' ');
        document.getElementById('main-hl').innerText = `H:${Math.round(Math.max(...temps))}¬∞  L:${Math.round(Math.min(...temps))}¬∞`;

        // Background & Animations
        applyWeatherEffects(now.conditionCode);

        // Hourly
        document.getElementById('hourly-list').innerHTML = currentData.slice(0, 24).map(h => `
            <div class="hourly-item">
                <div class="time">${h.forecastTimeUtc.split(' ')[1].substring(0,2)}</div>
                <div class="icon">${conditionIcons[h.conditionCode] || "‚òÅÔ∏è"}</div>
                <div class="temp">${Math.round(h.airTemperature)}¬∞</div>
            </div>
        `).join('');

        // 10-Day List
        const daily = {};
        currentData.forEach(ts => {
            const date = ts.forecastTimeUtc.split(' ')[0];
            if(!daily[date]) daily[date] = { temps: [], codes: [] };
            daily[date].temps.push(ts.airTemperature);
            daily[date].codes.push(ts.conditionCode);
        });

        document.getElementById('daily-list').innerHTML = Object.entries(daily).slice(0, 10).map(([date, info], i) => {
            const d = new Date(date);
            const label = i === 0 ? "Today" : d.toLocaleDateString('en-GB', { weekday: 'short' });
            const max = Math.round(Math.max(...info.temps));
            const min = Math.round(Math.min(...info.temps));
            
            return `
                <div class="daily-row">
                    <div class="day-name">${label}</div>
                    <div class="day-icon">${conditionIcons[info.codes[0]] || "‚òÅÔ∏è"}</div>
                    <div class="temp-bar-container">
                        <span style="font-size:15px; opacity:0.6; min-width:30px;">${min}¬∞</span>
                        <div class="temp-bar"><div class="temp-bar-fill" style="left:20%; width:60%;"></div></div>
                        <span style="font-size:15px; font-weight:600; min-width:30px;">${max}¬∞</span>
                    </div>
                </div>
            `;
        }).join('');
    }

    function applyWeatherEffects(code) {
        const body = document.getElementById('body');
        const fx = document.getElementById('bg-fx');
        fx.innerHTML = '';

        if(code.includes('clear')) {
            body.style.background = "var(--bg-sunny)";
            fx.innerHTML = '<div class="sun-ray"></div>';
        } else if(code.includes('cloud')) {
            body.style.background = "var(--bg-cloudy)";
            for(let i=0; i<3; i++) {
                let c = document.createElement('div');
                c.className = 'cloud-fx';
                c.style.top = (20 + i*20) + '%';
                c.style.width = (200 + Math.random()*200) + 'px';
                c.style.height = '100px';
                c.style.animationDelay = (i * 5) + 's';
                fx.appendChild(c);
            }
        } else {
            body.style.background = "var(--bg-rainy)";
        }
    }

    // Search logic
    document.getElementById('city-input').oninput = (e) => {
        const val = e.target.value.toLowerCase();
        const suggs = document.getElementById('suggestions');
        if(val.length < 2) { suggs.style.display='none'; return; }
        const matches = allPlaces.filter(p => p.name.toLowerCase().includes(val)).slice(0, 5);
        suggs.innerHTML = matches.map(p => `<div class="suggestion-item" onclick="fetchWeather('${p.code}', '${p.name}'); document.getElementById('suggestions').style.display='none'; document.getElementById('city-input').value=''">${p.name}</div>`).join('');
        suggs.style.display = 'block';
    }

    init();
</script>
</body>
</html>